# frozen_string_literal: true

class LegacyHearingUpdateForm < BaseHearingUpdateForm
  attr_accessor :aod, :scheduled_for

  protected

  def update_hearing
    hearing.update_caseflow_and_vacols(hearing_updates)

    # Because of how we map the hearing time, we need to refresh the VACOLS data after saving
    HearingRepository.load_vacols_data(hearing)
  end

  private

  def hearing_updates
    updates = {
      aod: aod,
      bva_poc: bva_poc,
      disposition: disposition,
      hearing_location_attributes: hearing_location_attributes,
      hold_open: hold_open,
      judge_id: judge_id,
      military_service: military_service,
      notes: notes,
      prepped: prepped,
      representative_name: representative_name,
      room: room,
      scheduled_for: scheduled_for,
      scheduled_time_string: scheduled_time_string,
      summary: summary,
      transcript_requested: transcript_requested,
      witness: witness
    }.compact

    HearingTimeService.build_legacy_params_with_time(hearing, updates)
  end
end
